<!-- survey.html -->
{% extends 'base.html' %}

{% block title %}Survey{% endblock %}
{% block head %}
{% load static %}
<link rel="stylesheet" href="{% static 'css/survey.css' %}">
{% endblock %}

{% block content %}
<div class="container survey-wrapper">
    {% if survey.surveytranslation_set.all %}
        {% for survey_translation in survey.surveytranslation_set.all %}
            {% if survey_translation.language == LANGUAGE_CODE %}
                <h1 class="survey-title">{{survey_translation.title}}</h1>
            {% endif %}
        {% endfor %}
    {% else %}
        <h1 class="survey-title">{{survey.name}}</h1>
    {% endif %}


    <form action="{{ request.get_full_path }}" method="post" class="container" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="language" value="{{ LANGUAGE_CODE }}">
        <div class="row">
            <div class="input-field col s12">
                {% for question in survey.checked_questions %}
<<<<<<< HEAD
                    <div class="question-container {% if question.hidden %}hide hiddable{% endif %}">
                    {% if question.image %}
                        <img src="{{ question.image.url }}" alt="{{ question.image.name }}">
                    {% endif %}
=======
                    <div class="question-container {% if question.hidden %}hide hiddable{% endif %}"  >
>>>>>>> 305fe3d9b419da1c7ac1992616500c5597787196
                    {% if question.questiontranslation_set.all %}
                        {% for question_translation in question.questiontranslation_set.all %}
                            {% if question_translation.language == LANGUAGE_CODE %}
                                {% with options=question_translation.options %}
                                    <p>{{ question_translation.question_prompt }}</p>
                                    {% if question.question_type == 'text' %}
                                        <input type="text" name="question_{{ question.name }}" required>
                                    {% elif question.question_type == 'prompt' %}
                                        <br>
                                    {% elif question.question_type == 'multiple_select' %}
                                        <div class="option-container {% if question.long_text %}block-label{% endif %}">
                                            {% for option in options %}
                                                <label {% if question.long_text %}class="block-label"{% endif %}>
                                                    <input type="checkbox" name="question_{{ question.name }}" value="{{ option.value }}">
                                                    <span>{{ option.label }}</span>
                                                    {{ option.label|length }}
                                                </label>
                                            {% endfor %}
                                        </div>
                                        <br>
                                    {% elif question.question_type == 'number' %}
                                        <input type="number" name="question_{{ question.name }}" required>
                                    {% elif question.question_type == 'recording' %}
                                        <button id="startButton">Start Recording</button>
                                        <button id="stopButton" disabled>Stop Recording</button>
                                        <audio id="audioPlayer" controls></audio>
                                        <input type="hidden" id="audioBlob_{{question.name}}" name="audio_{{question.name}}">
                                    {% else %}
                                        <div class="option-container{% if question.long_text %}block-label{% endif %}">
<<<<<<< HEAD
                                            {% for option in options %}
                                                <label {% if question.long_text %}class="block-label"{% endif %}>
                                                    <input type="radio" name="question_{{ question.name }}" value="{{ option.value }}">
                                                    <span>{{ option.label }}</span>
                                                </label>
                                            {% endfor %}
=======
                                                {% for option in options %}
                                                    <label {% if question.long_text %}class="block-label"{% endif %}>
                                                        <input type="radio" name="question_{{ question.name }}" value="{{ option.value }}">
                                                        <span>{{ option.label }}</span>
                                                    </label>
                                                {% endfor %}
>>>>>>> 305fe3d9b419da1c7ac1992616500c5597787196
                                        </div>
                                    {% endif %}
                                    <br><br>
                                {% endwith %}
                            {% endif %}
                        {% endfor %}
                    {% endif %}
                    </div>
                {% endfor %}
                <div class="row">
                    <div class="input-field col s12">
                        <button class="btn waves-effect waves-light" type="submit" name="action">Submit</button>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block js %}
    <script src="{% static 'js/surveys.js' %}"></script>
{% endblock %}
